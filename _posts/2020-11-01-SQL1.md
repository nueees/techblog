---
toc: true
layout: post
description: section1
categories: [sql]
title: SQL1
---

Python Algorithm Practice

---

## 1.1. Sub-String

### input:  
name, occupation  
Ashley Professor  
Samantha Actor  
Julia Doctor  
Britney Professor  
Maria Professor  
Meera Professor  
Priya Doctor  
Priyanka Professor  
Jennifer Actor  
Ketty Actor  
Belvet Professor  
Naomi Professor  
Jane Singer  
Jenny Singer  
Kristeen Singer  
Christeen Singer  
Eve Actor  
Aamina Doctor  

### output:
Samantha(D)  
Julia(A)  
Maria(A)  
Meera(S)  

```
select
        name||'('||substr(occupation,1,1)||')'
  from OCCUPATIONS
;  
```

---

## 1.2. Pivot

### input:  
name, occupation  
Ashley Professor  
Samantha Actor  
Julia Doctor  
Britney Professor  
Maria Professor  
Meera Professor  
Priya Doctor  
Priyanka Professor  
Jennifer Actor  
Ketty Actor  
Belvet Professor  
Naomi Professor  
Jane Singer  
Jenny Singer  
Kristeen Singer  
Christeen Singer  
Eve Actor  
Aamina Doctor  

### output:
doc,pro,sing,act
Jenny,    Ashley,     Meera,  Jane  
Samantha, Christeen,  Priya,  Julia  
NULL,     Ketty,      NULL,   Maria  

```
with wocc as (
    select  case 
                when occupation = 'Doctor' then name 
                else Null
            end as doc
            ,case 
                when occupation = 'Professor' then name 
                else Null
            end as pro
            ,case 
                when occupation = 'Singer' then name 
                else Null
            end as sing
            ,case 
                when occupation = 'Actor' then name 
                else Null
            end as act
     from OCCUPATIONS
 )
 select * 
 from (
     select d.doc, p.pro, s.sing, a.act
     from
             (select row_number() over (order by sub.doc) col, sub.doc from wocc sub) d
            ,(select row_number() over (order by sub.pro) col, sub.pro from wocc sub) p
            ,(select row_number() over (order by sub.sing) col, sub.sing from wocc sub) s
            ,(select row_number() over (order by sub.act) col, sub.act from wocc sub) a
    where d.col = p.col
      and p.col = s.col
      and s.col = a.col
 )
 where rownum < (select cnt
                 from (
                     select occupation, count(*) as cnt
                     from OCCUPATIONS
                     group by occupation
                     order by 2 desc
                     )
                where rownum = 1)+1
;                
```


---

## 1.3. Hierarchical Table

### input: 
child, parent  
1,2  
3,2  
6,8  
9,8  
2,5  
8,5  
5,null  

### input: 
1 Leaf  
2 Inner  
3 Leaf  
5 Root  
6 Leaf  
8 Inner  
9 Leaf  


```
select 
       N
     , case
            when CONNECT_BY_ISLEAF = 1 then 'Leaf'
            when CONNECT_BY_ISLEAF = 0 and P is null then 'Root'
            else 'Inner'
      end
from BST T1
start with P is null
connect by prior N = P
order by N
;

```

---

## 1.4. Hierarchical Table2

### input: 
COMPANY  
c_code, founder  
C1, Monika  
C2, Samantha  

LEAD_MANAGER  
l_m_code, c_code  
LM1, C1  
LM2, C2  

SENIOR_MANAGER  
s_m_code, l_m_code, c_code  
SM1, LM1, C1  
SM2, LM1, C1  
SM3, LM2, C2  

MANAGER  
m_code, s_m_code, l_m_code, c_code  
M1, SM1, LM1, C1  
M2, SM3, LM2, C2  
M3, SM3, LM2, C2  

EMPLOYEE  
s_m_code, l_m_code, c_code  
E1, M1, SM1, LM1, C1  
E2, M1, SM1, LM1, C1  
E3, M2, SM3, LM2, C2  
E4, M3, SM3, LM2, C2  


### output: 
C1 Monika 1 2 1 2  
C2 Samantha 1 1 2 2  


```

```


---




