<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>SQL2 | Cho’s Tech blog</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="SQL2" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="section2" />
<meta property="og:description" content="section2" />
<link rel="canonical" href="https://nueees.github.io/techblog/sql/2020/11/02/SQL2.html" />
<meta property="og:url" content="https://nueees.github.io/techblog/sql/2020/11/02/SQL2.html" />
<meta property="og:site_name" content="Cho’s Tech blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-11-02T00:00:00-06:00" />
<script type="application/ld+json">
{"description":"section2","url":"https://nueees.github.io/techblog/sql/2020/11/02/SQL2.html","@type":"BlogPosting","headline":"SQL2","dateModified":"2020-11-02T00:00:00-06:00","datePublished":"2020-11-02T00:00:00-06:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://nueees.github.io/techblog/sql/2020/11/02/SQL2.html"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/techblog/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://nueees.github.io/techblog/feed.xml" title="Cho's Tech blog" /><link rel="shortcut icon" type="image/x-icon" href="/techblog/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js" integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js" integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha512-0doc9hKxR3PYwso42RD1p5ySZpzzuDiOwMrdCEh2WdJZCjcmFKc/wEnL+z8fBQrnHoiNWbo+3fiGkOYXBdQp4A==" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/techblog/">Cho&#39;s Tech blog</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/techblog/about/">About Me</a><a class="page-link" href="/techblog/gitInfo/">gitInfo</a><a class="page-link" href="/techblog/search/">Search</a><a class="page-link" href="/techblog/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">SQL2</h1><p class="page-description">section2</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2020-11-02T00:00:00-06:00" itemprop="datePublished">
        Nov 2, 2020
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      6 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/techblog/categories/#sql">sql</a>
        
      
      </p>
    

    </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#21-sql-project-planning">2.1. SQL Project Planning</a>
<ul>
<li class="toc-entry toc-h3"><a href="#input">input:</a></li>
<li class="toc-entry toc-h3"><a href="#output">output:</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#22-interviews">2.2. Interviews</a>
<ul>
<li class="toc-entry toc-h3"><a href="#input-1">input:</a></li>
<li class="toc-entry toc-h3"><a href="#output-1">output:</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#23-placements">2.3. Placements</a>
<ul>
<li class="toc-entry toc-h3"><a href="#input-2">input:</a></li>
<li class="toc-entry toc-h3"><a href="#output-2">output:</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#24-symmetric-pairs">2.4. Symmetric Pairs</a>
<ul>
<li class="toc-entry toc-h3"><a href="#input-3">input:</a></li>
<li class="toc-entry toc-h3"><a href="#output-3">output:</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#25-print-prime-numbers">2.5. Print Prime numbers</a>
<ul>
<li class="toc-entry toc-h3"><a href="#input-4">input:</a></li>
<li class="toc-entry toc-h3"><a href="#output-4">output:</a></li>
</ul>
</li>
</ul><p>HackerRank</p>

<hr>

<h2 id="21-sql-project-planning">
<a class="anchor" href="#21-sql-project-planning" aria-hidden="true"><span class="octicon octicon-link"></span></a>2.1. SQL Project Planning</h2>

<h3 id="input">
<a class="anchor" href="#input" aria-hidden="true"><span class="octicon octicon-link"></span></a>input:</h3>
<p>1 2015-10-01 2015-10-02<br>
24 2015-10-02 2015-10-03<br>
2 2015-10-03 2015-10-04<br>
23 2015-10-04 2015-10-05 -&gt; 3 days<br>
3 2015-10-11 2015-10-12<br>
22 2015-10-12 2015-10-13 -&gt; 2 days<br>
4 2015-10-15 2015-10-16 -&gt; 1 days<br>
21 2015-10-17 2015-10-18 -&gt; 1 days<br>
5 2015-10-19 2015-10-20 -&gt; 1 days<br>
20 2015-10-21 2015-10-22 -&gt; 1 days<br>
6 2015-10-25 2015-10-26<br>
19 2015-10-26 2015-10-27<br>
7 2015-10-27 2015-10-28<br>
18 2015-10-28 2015-10-29<br>
8 2015-10-29 2015-10-30<br>
17 2015-10-30 2015-10-31<br>
9 2015-11-01 2015-11-02<br>
16 2015-11-04 2015-11-05<br>
10 2015-11-07 2015-11-08<br>
15 2015-11-06 2015-11-07<br>
11 2015-11-05 2015-11-06<br>
14 2015-11-11 2015-11-12<br>
12 2015-11-12 2015-11-13<br>
13 2015-11-17 2015-11-18</p>

<h3 id="output">
<a class="anchor" href="#output" aria-hidden="true"><span class="octicon octicon-link"></span></a>output:</h3>
<p>2015-10-15 2015-10-16<br>
2015-10-17 2015-10-18<br>
2015-10-19 2015-10-20<br>
2015-10-21 2015-10-22<br>
2015-11-01 2015-11-02<br>
2015-11-17 2015-11-18<br>
2015-10-11 2015-10-13<br>
2015-11-11 2015-11-13<br>
2015-10-01 2015-10-05<br>
2015-11-04 2015-11-08<br>
2015-10-25 2015-10-31</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT Start_Date, MIN(End_Date)
FROM 
    (SELECT Start_Date FROM Projects WHERE Start_Date NOT IN (SELECT End_Date FROM Projects)) a,
    (SELECT End_date FROM PROJECTS WHERE End_date NOT IN (SELECT Start_Date FROM Projects)) b
where Start_Date &lt; End_date
GROUP BY Start_Date
ORDER BY (Start_Date - MIN(End_date)) DESC, Start_Date
;
</code></pre></div></div>

<hr>

<h2 id="22-interviews">
<a class="anchor" href="#22-interviews" aria-hidden="true"><span class="octicon octicon-link"></span></a>2.2. Interviews</h2>

<h3 id="input-1">
<a class="anchor" href="#input-1" aria-hidden="true"><span class="octicon octicon-link"></span></a>input:</h3>
<p>contest_id total_submissions total_accepted_submissions total_views total_unique_views<br>
845 38 17 38 19<br>
845 94 13 22 22<br>
845 73 21 22 22<br>
845 40 21 22 22<br>
845 72 9 98 11<br>
845 38 25 98 11<br>
845 67 14 98 11<br>
845 70 19 98 11<br>
845 17 14 79 17<br>
845 17 14 17 16<br>
845 38 17 65 12<br>
845 49 20 80 24<br>
845 41 16 80 24<br>
845 NULL NULL 40 25<br>
845 25 21 35 17<br>
845 70 8 35 17<br>
845 NULL NULL 84 17<br>
845 38 17 50 14<br>
845 73 6 33 25<br>
845 48 25 33 25<br>
845 17 14 22 18<br>
845 72 9 31 22<br>
845 38 25 31 22<br>
845 67 14 31 22<br>
845 70 19 31 22<br>
845 26 14 33 25<br>
845 31 16 33 25<br>
845 52 7 56 12<br>
845 NULL NULL 20 20<br>
845 85 23 31 18<br>
845 23 21 31 18<br>
845 49 20 98 17<br>
845 41 16 98 17<br>
845 26 14 39 16<br>
845 31 16 39 16<br>
845 73 6 46 10<br>
845 48 25 46 10<br>
845 52 7 22 19<br>
845 49 20 41 17<br>
845 41 16 41 17<br>
845 17 14 17 10<br>
845 96 20 24 15<br>
845 97 25 24 15<br>
845 73 6 22 12<br>
845 48 25 22 12<br>
845 NULL NULL 63 19<br>
845 27 17 91 25<br>
845 73 6 85 12<br>
845 48 25 85 12<br>
845 85 23 32 23<br>
845 23 21 32 23<br>
845 49 20 82 17<br>
845 41 16 82 17<br>
845 NULL NULL 93 7<br>
845 38 17 17 7<br>
845 52 7 29 6<br>
845 81 6 NULL NULL<br>
845 46 20 NULL NULL<br>
845 93 19 NULL NULL<br>
845 42 25 NULL NULL<br>
845 86 25 NULL NULL<br>
845 55 25 NULL NULL<br>
845 95 9 NULL NULL<br>
845 77 8 NULL NULL<br>
845 14 10 NULL NULL<br>
845 29 9 NULL NULL<br>
845 25 16 NULL NULL<br>
845 92 16 NULL NULL</p>

<h3 id="output-1">
<a class="anchor" href="#output-1" aria-hidden="true"><span class="octicon octicon-link"></span></a>output:</h3>
<p>845 579 Rose 1987 580 1635 566</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>select  con.contest_id,
        con.hacker_id, 
        con.name, 
        sum(total_submissions), 
        sum(total_accepted_submissions), 
        sum(total_views), sum(total_unique_views)
from contests con 
join colleges col on con.contest_id = col.contest_id 
join challenges cha on  col.college_id = cha.college_id 
left join
(select challenge_id, sum(total_views) as total_views, sum(total_unique_views) as total_unique_views
   from view_stats 
 group by challenge_id) vs on cha.challenge_id = vs.challenge_id 
left join
(select challenge_id, sum(total_submissions) as total_submissions, sum(total_accepted_submissions) as total_accepted_submissions 
   from submission_stats 
 group by challenge_id) ss on cha.challenge_id = ss.challenge_id
group by con.contest_id, con.hacker_id, con.name
order by con.contest_id
;
</code></pre></div></div>

<hr>

<h2 id="23-placements">
<a class="anchor" href="#23-placements" aria-hidden="true"><span class="octicon octicon-link"></span></a>2.3. Placements</h2>

<h3 id="input-2">
<a class="anchor" href="#input-2" aria-hidden="true"><span class="octicon octicon-link"></span></a>input:</h3>
<p>Students:<br>
1 Samantha <br>
2 Julia    <br>
3 Britney  <br>
4 Kristeen <br>
5 Dyana    <br>
6 Jenny    <br>
7 Christene<br>
8 Meera    <br>
9 Priya    <br>
10 Priyanka<br>
11 Paige   <br>
12 Jane    <br>
13 Belvet  <br>
14 Scarlet <br>
15 Salma   <br>
16 Amanda  <br>
17 Maria   <br>
18 Stuart  <br>
19 Aamina  <br>
20 Amina</p>

<p>Friends:<br>
  1 14 <br>
  2 15 <br>
  3 18 <br>
  4 19 <br>
  5 20 <br>
  6 5  <br>
  7 6  <br>
  8 7  <br>
  9 8  <br>
  10 1 <br>
  11 2 <br>
  12 3 <br>
  13 4 <br>
  14 9 <br>
  15 10<br>
  16 11<br>
  17 12<br>
  18 13<br>
  19 16<br>
  20 17</p>

<p>Packages:<br>
1 15.5<br>
2 15.6<br>
3 16.7<br>
4 18.8<br>
5 31.5<br>
6 45 <br>
7 47 <br>
8 46 <br>
9 39 <br>
10 11.1 <br>
11 12.1 <br>
12 13.1 <br>
13 14.1 <br>
14 15.1 <br>
15 17.1 <br>
16 21.1 <br>
17 31.1 <br>
18 13.15<br>
19 33.33<br>
20 22.16</p>

<h3 id="output-2">
<a class="anchor" href="#output-2" aria-hidden="true"><span class="octicon octicon-link"></span></a>output:</h3>
<p>Samantha<br>
Julia<br>
Scarlet</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>select s.name
     -- , s.id
     -- , mysal.salary
     -- , f.friend_id
     -- , frdsal.salary
from Students s
join Packages mysal on s.id = mysal.id
join Friends f on s.id = f.id
join Packages frdsal on f.friend_id = frdsal.id
where mysal.salary &lt; frdsal.salary
order by frdsal.salary
;
</code></pre></div></div>

<hr>

<h2 id="24-symmetric-pairs">
<a class="anchor" href="#24-symmetric-pairs" aria-hidden="true"><span class="octicon octicon-link"></span></a>2.4. Symmetric Pairs</h2>

<h3 id="input-3">
<a class="anchor" href="#input-3" aria-hidden="true"><span class="octicon octicon-link"></span></a>input:</h3>
<p>11 11<br>
11 15 Symmetric(11,15)<br>
12 12<br>
13 13 Symmetric(13,13)<br>
13 13 Symmetric(13,13)
14 14<br>
14 12<br>
15 15<br>
15 11 Symmetric(11,15)</p>

<h3 id="output-3">
<a class="anchor" href="#output-3" aria-hidden="true"><span class="octicon octicon-link"></span></a>output:</h3>
<p>11 15<br>
13 13</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
select outf.x
     , outf.y
     , inf.x
     , inf.y
join까지
&gt;   11 11 11 11
    11 15 15 11
    12 12 12 12
    13 13 13 13
    13 13 13 13
    13 13 13 13
    13 13 13 13
    14 14 14 14
    15 11 11 15
    15 15 15 15


select outf.x
     , outf.y
     , count(inf.x)
group by까지  
&gt;   11 11 1
    11 15 1
    12 12 1
    13 13 4
    14 14 1
    15 11 1
    15 15 1

select outf.x
     , outf.y
     , count(inf.x)
from Functions outf
join Functions inf on ( outf.x = inf.y and outf.y = inf.x) 
group by outf.x, outf.y
having outf.x &lt; outf.y 
    or count(outf.x) &gt; 1
order by 1
;

&gt; 11 15 
  13 13 

</code></pre></div></div>

<hr>

<h2 id="25-print-prime-numbers">
<a class="anchor" href="#25-print-prime-numbers" aria-hidden="true"><span class="octicon octicon-link"></span></a>2.5. Print Prime numbers</h2>
<p>소수 구하기</p>

<h3 id="input-4">
<a class="anchor" href="#input-4" aria-hidden="true"><span class="octicon octicon-link"></span></a>input:</h3>
<p>X</p>

<h3 id="output-4">
<a class="anchor" href="#output-4" aria-hidden="true"><span class="octicon octicon-link"></span></a>output:</h3>
<p>2&amp;3&amp;5&amp;7</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>소수 아닌 애들 거르는 작업
with num as 
(select level as no
        from dual
        connect by level &lt;= 10)
select n1.no, n2.no, mod(n1.no, n2.no)
from num n1
   , num n2
where n1.no &gt; n2.no
  and ( n2.no &lt;&gt; 1 and mod(n1.no, n2.no) = 0 )
-- group by n1.no
order by 1
 ;

&gt; 4 2 0
  6 2 0
  6 3 0
  8 2 0
  8 4 0
  9 3 0
  10 2 0
  10 5 0
  
  
pivot 전
with num as 
(select level as no
        from dual
        connect by level &lt;= 10)
select num.no
from num
where num.no not in (select n1.no
                from num n1
                   , num n2
                where n1.no &gt; n2.no
                  and ( n2.no &lt;&gt; 1 and mod(n1.no, n2.no) = 0 )
                group by n1.no)
and num.no &lt;&gt; 1
order by 1
;
&gt; 2
  3
  5
  7
  
LIST_AGG로 피봇팅
with num as 
(select level as no
        from dual
        connect by level &lt;= 10)
select LISTAGG(num.no,'&amp;') within group(order by num.no)
from num
where num.no not in (select n1.no
                from num n1
                   , num n2
                where n1.no &gt; n2.no
                  and ( n2.no &lt;&gt; 1 and mod(n1.no, n2.no) = 0 )
                group by n1.no)
and num.no &lt;&gt; 1
order by 1
;
&gt; 2&amp;3&amp;5&amp;7

</code></pre></div></div>

<hr>


  </div><a class="u-url" href="/techblog/sql/2020/11/02/SQL2.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/techblog/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/techblog/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/techblog/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>A challenge-loving junior data engineer.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/nueees" target="_blank" title="nueees"><svg class="svg-icon grey"><use xlink:href="/techblog/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/nueees" target="_blank" title="nueees"><svg class="svg-icon grey"><use xlink:href="/techblog/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
